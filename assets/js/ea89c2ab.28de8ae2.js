"use strict";(self.webpackChunkblog_cyber=self.webpackChunkblog_cyber||[]).push([[8090],{7397:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>p,frontMatter:()=>l,metadata:()=>i,toc:()=>o});var r=s(4848),a=s(8453);const l={title:"Header",tags:["web","nodejs","intro"]},t=void 0,i={id:"Hackropole/Web/Header",title:"Header",description:"Header est un challenge orient\xe9 Web sur la plateforme Hackropole.",source:"@site/docs/Hackropole/Web/Header.md",sourceDirName:"Hackropole/Web",slug:"/Hackropole/Web/Header",permalink:"/blog/docs/Hackropole/Web/Header",draft:!1,unlisted:!1,tags:[{label:"web",permalink:"/blog/docs/tags/web"},{label:"nodejs",permalink:"/blog/docs/tags/nodejs"},{label:"intro",permalink:"/blog/docs/tags/intro"}],version:"current",frontMatter:{title:"Header",tags:["web","nodejs","intro"]},sidebar:"tutorialSidebar",previous:{title:"Babel Web",permalink:"/blog/docs/Hackropole/Web/Babel Web"},next:{title:"Push it to the limit",permalink:"/blog/docs/Hackropole/Web/Push it to the limit"}},c={},o=[{value:"Installation",id:"installation",level:2},{value:"Exploration",id:"exploration",level:2},{value:"Exploitation",id:"exploitation",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://hackropole.fr/fr/challenges/web/fcsc2022-web-header/",children:"Header"})," est un challenge orient\xe9 Web sur la plateforme ",(0,r.jsx)(n.a,{href:"https://hackropole.fr",children:"Hackropole"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Ce challenge faisait partie du FCSF 2022. Il est not\xe9 comme difficult\xe9 ",(0,r.jsx)(n.strong,{children:"Intro"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,r.jsxs)(n.p,{children:["T\xe9l\xe9chargez le ",(0,r.jsx)(n.em,{children:"docker-compose.yml"})," sur leur site ou alors via la commande:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"curl https://hackropole.fr/challenges/fcsc2020-web-babel-web/docker-compose.public.yml -o docker-compose.yml\n"})}),"\n",(0,r.jsx)(n.p,{children:"Lancez le challenge en ex\xe9cutant la commande:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-docker",children:"docker compose up\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Vous pouvez alors acc\xe9der au challenge via l'URL ",(0,r.jsx)(n.a,{href:"http://localhost:8000",children:"http://localhost:8000"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"exploration",children:"Exploration"}),"\n",(0,r.jsxs)(n.p,{children:["La page d'accueil du challenge contient peu d'informations. Cependant une barre de navigation est pr\xe9sente avec le titre du challenge et un lien nomm\xe9 ",(0,r.jsx)(n.strong,{children:"Source"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"En cliquant sur ce lien, ceci s'affiche:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"const fs = require('fs');\nconst express = require('express');\nconst escape = require('escape-html')\nvar favicon = require('serve-favicon');\nconst app = express();\n\napp.use(favicon('favicon.ico'));\napp.set('view engine', 'ejs');\napp.use(express.static('public'));\n\napp.get('/', async (req, res) => {\n    var verif = req.header(\"X-FCSC-2022\");\n    if (verif == \"Can I get a flag, please?\") {\n        var flag = fs.readFileSync(\"flag.txt\");\n        res.status(200);\n        res.render(\"pages/index\", {\n            type: \"success\",\n            msg: \"Here it is: \" + flag,\n        });\n        return res.end();\n    } else {\n        res.status(200);\n        res.render(\"pages/index\", {\n            type: \"warning\",\n            msg: \"No flag for you. Want a meme instead?\",\n        });\n        return res.end();\n    }\n});\n\napp.get('/source', async (req, res) => {\n    const source = fs.readFileSync(__filename);\n    res.render(\"pages/source\", {\n        source: escape(source),\n    });\n    return res.end();\n});\n\napp.listen(8000);\n"})}),"\n",(0,r.jsx)(n.p,{children:"Il semblerait que ce soit le code source du site que nous visitons actuellement. D\xe9coupons le ensemble."}),"\n",(0,r.jsxs)(n.p,{children:["L'application est une application ",(0,r.jsx)(n.a,{href:"https://nodejs.org/en",children:(0,r.jsx)(n.strong,{children:"NodeJs"})})," utilisant le framework ",(0,r.jsx)(n.a,{href:"https://expressjs.com",children:(0,r.jsx)(n.strong,{children:"ExpressJs"})}),"."]}),"\n",(0,r.jsx)(n.p,{children:"On peut y voir 2 routes principales:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"/, plus commun\xe9ment appel\xe9 la racine du site"}),"\n",(0,r.jsx)(n.li,{children:"/source, qui est la route sur laquelle nous sommes"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Int\xe9ressont nous \xe0 la racine:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'app.get(\'/\', async (req, res) => {\n    var verif = req.header("X-FCSC-2022");\n    if (verif == "Can I get a flag, please?") {\n        var flag = fs.readFileSync("flag.txt");\n        res.status(200);\n        res.render("pages/index", {\n            type: "success",\n            msg: "Here it is: " + flag,\n        });\n        return res.end();\n    } else {\n        res.status(200);\n        res.render("pages/index", {\n            type: "warning",\n            msg: "No flag for you. Want a meme instead?",\n        });\n        return res.end();\n    }\n});\n'})}),"\n",(0,r.jsxs)(n.p,{children:["L'application commence par r\xe9cup\xe9rer un ",(0,r.jsx)(n.strong,{children:"header"})," nomm\xe9 ",(0,r.jsx)(n.strong,{children:"X-FCSC-2022"})," dans la requ\xeate que nous lui faisons."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'var verif = req.header("X-FCSC-2022");\n'})}),"\n",(0,r.jsxs)(n.p,{children:["L'application v\xe9rifie ensuite si ce header a la valeur ",(0,r.jsx)(n.strong,{children:'"Can I get a flag, please?"'}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Si oui, elle lit le fichier ",(0,r.jsx)(n.strong,{children:"flag.txt"})," puis nous le renvoie."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'var flag = fs.readFileSync("flag.txt");\nres.status(200);\nres.render("pages/index", {\n    type: "success",\n    msg: "Here it is: " + flag,\n});\nreturn res.end();\n'})}),"\n",(0,r.jsx)(n.p,{children:"Dans l'autre cas, elle nous renvoie la page d'accueil."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'res.status(200);\nres.render("pages/index", {\n    type: "warning",\n    msg: "No flag for you. Want a meme instead?",\n});\nreturn res.end();\n'})}),"\n",(0,r.jsx)(n.h2,{id:"exploitation",children:"Exploitation"}),"\n",(0,r.jsxs)(n.p,{children:["On comprends alors qu'il faut envoyer une requ\xeate avec le header ",(0,r.jsx)(n.strong,{children:'"X-FCSC-2022: Can I get a flag, please?"'})," pour recevoir le flag. C'est ce que nous allons faire."]}),"\n",(0,r.jsxs)(n.p,{children:["Pour cela, nous pouvons faire une requ\xeate avec ",(0,r.jsx)(n.em,{children:"cURL"})," en incluant le param\xe8tre ",(0,r.jsx)(n.em,{children:"--header"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'curl --header "X-FCSC-2022: Can I get a flag, please?" http://localhost:8000\n'})}),"\n",(0,r.jsx)(n.p,{children:"Le serveur nous renvoie ceci:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'--snip--\n<div class="container">\n        <div class="starter-template">\n                <div id="alert" class="alert alert-success">\n                        <strong>Here it is: FCSC{9ec57a4a72617c4812002726750749dd193d5fbbfeef54a27a9b536f00d89dfb}</strong>\n                </div>\n                <img src="meme.jpeg" class="img-fluid" />\n        </div>\n</div>\n--snip--\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Bravo !"})," , vous avez r\xe9ussi ce challenge. Copiez le flag et entrez le sur le site d'Hackropole pour confirmer votre victoire."]})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>i});var r=s(6540);const a={},l=r.createContext(a);function t(e){const n=r.useContext(l);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),r.createElement(l.Provider,{value:n},e.children)}}}]);